# Ontology Viewer — Визуальный редактор онтологий навыков и компетенций

**Ontology Viewer** — это веб-приложение для визуального создания, редактирования и анализа онтологий знаний и навыков. Приложение работает полностью в браузере, без необходимости в сервере, и позволяет работать с графами навыков как с интерактивными диаграммами.

## Назначение и возможности

Приложение решает следующие задачи:

- **Создание и редактирование графов навыков** — визуальное добавление узлов (навыков) и связей между ними
- **Гибкая схема данных** — структура узлов и типы связей определяются схемой, что позволяет использовать приложение для разных предметных областей без изменения кода
- **Импорт и экспорт JSON** — загрузка и сохранение онтологий в стандартном JSON формате
- **Интерактивное отображение** — масштабирование, перемещение, автоматическая раскладка графа

## Что такое онтология?

В контексте этого приложения **онтология** — это структурированное описание знаний в виде **семантически типизированного ориентированного графа**:

- **Узлы (Nodes)** — навыки, знания, компетенции (например: "Python", "Алгоритмы")
- **Связи (Edges)** — типизированные отношения между навыками:
  - `includes` — "включает в себя / состоит из"
  - `requires` — "требует знания / пререквизит"
  - `related_to` — "связан с"
- **Схема (Schema)** — описание структуры: какие поля есть у узлов, какие типы связей допустимы

Вся информация хранится в одном JSON-файле и может быть легко экспортирована или обработана другими инструментами.

## Быстрый старт

### Установка зависимостей

```bash
npm install
```

### Запуск в режиме разработки

```bash
npm run dev
```

Приложение откроется по адресу `http://localhost:5173` (или другому, если 5173 занят).

### Сборка для продакшена

```bash
npm run build
```

Результат будет в папке `dist/`.

## Как использовать приложение

### 1. Загрузка или создание онтологии

#### Создание пустой онтологии

- Нажмите кнопку **"Create New"** на панели инструментов
- Вы получите пустую онтологию со пустой схемой

#### Загрузка существующей онтологии

- Нажмите **"Load"** и выберите JSON-файл
- Приложение загрузит схему, узлы и связи
- Граф автоматически отобразится на экране

#### Объединение онтологий

- Нажмите **"Import"** чтобы добавить узлы и связи из другого файла
- При слиянии приложение попытается объединить схемы

### 2. Работа с графом

#### Навигация

- **Масштабирование**: колесо мыши или кнопки на панели управления
- **Перемещение (Pan)**: левая кнопка мыши

#### Выбор элементов

- **Левый клик на узел** — выделение узла и отображение его свойств в форме редактирования
- **Левый клик на связь** — выделение связи и отображение её типа и свойств
- **Левый клик на пустое место** — снятие выделения

#### Контекстное меню

- **Правый клик на пустом месте** - контекстное меню добавления узла
- **Правый клик на узле** - контекстное меню удаления узла
- **Правый клик на связи** - контекстное меню удаления связи

#### Горячие клавиши

- **delete / backspace** - удаление выделенного узла или связи
- **CTRL+Z** - отменить действие (undo)
- **CTRL+Y / CTRL+SHIFT+Z** - redo
- **ESC** - снять выделение, закрыть контекстное меню

#### Редактирование узла или связи

1. Выберите узел или связь на графе (левый клик)
2. Отредактируйте его поля в боковой панели справа
3. Изменения применяются сразу

#### Создание связи

1. Перетащите стрелку от узла-источника на узел-получатель
2. Новая связь будет создана со стандартным типом
3. Измените тип и свойства связи в боковой панели справа

#### Редактирование связи

1. Кликните на связь (линию между узлами)
2. В боковой панели справа измените тип связи или другие свойства
3. Изменения применяются сразу

### 3. Использование схемы

#### Что такое схема?

Схема определяет:

- Какие **типы узлов** допустимы (например: "Skill", "Topic", "Resource") и какие **поля** есть у каждого типа узла
- Какие **типы связей** допустимы (например: "includes", "requires", "related_to") и какие **поля** есть у каждого типа связи
- Свойства полей (тип, обязательность, значения по умолчанию)

#### Редактирование схемы

Нажмите на вкладку **"Schema Editor"** для редактирования структуры:

- **Node Types** — добавление/удаление типов узлов и их полей
- **Edge Types** — добавление/удаление типов связей и их полей

При редактировании схемы новые поля автоматически появляются в формах редактирования узлов и связей.

### 4. Сохранение и экспорт

#### Экспорт онтологии

- Нажмите **"Export"**
- JSON-файл с полной онтологией загрузится на ваш компьютер
- Файл содержит схему, все узлы, координаты позиций и связи

## Структура данных (JSON формат)

### Пример валидной онтологии:

```json
{
  "schema": {
    "nodeTypes": {
      "nt_skill": {
        "name": "Skill",
        "fields": {
          "f_name": {
            "id": "f_name",
            "name": "name",
            "type": "string",
            "required": true
          },
          "f_category": {
            "id": "f_category",
            "name": "category",
            "type": "enum",
            "options": ["programming", "math", "tool"],
            "required": false
          },
          "f_description": {
            "id": "f_description",
            "name": "description",
            "type": "string",
            "required": false
          }
        }
      }
    },
    "edgeTypes": {
      "et_includes": {
        "name": "includes",
        "directed": true,
        "fields": {}
      },
      "et_requires": {
        "name": "requires",
        "directed": true,
        "fields": {}
      },
      "et_related_to": {
        "name": "related_to",
        "directed": false,
        "fields": {}
      }
    }
  },
  "nodes": [
    {
      "id": "1",
      "typeId": "nt_skill",
      "properties": {
        "f_name": "Python",
        "f_category": "programming",
        "f_description": "Язык программирования"
      },
      "position": {
        "x": 75,
        "y": 25
      }
    },
    {
      "id": "2",
      "typeId": "nt_skill",
      "properties": {
        "f_name": "Списки и массивы",
        "f_category": "programming"
      },
      "position": {
        "x": 75,
        "y": 125
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "1",
      "target": "2",
      "typeId": "et_includes",
      "properties": {}
    }
  ]
}
```

### Описание структуры:

```json
{
  "schema": {
    "nodeTypes": {},
    "edgeTypes": {}
  },
  "nodes": [],
  "edges": []
}
```

#### Schema

**nodeTypes** — объект с описанием типов узлов:

```json
{
  "nodeTypes": {
    "nt_skill": {
      "name": "Skill",
      "fields": {
        "f_name": {
          "id": "f_name",
          "name": "name",
          "type": "string",
          "required": true
        },
        "f_category": {
          "id": "f_category",
          "name": "category",
          "type": "enum",
          "options": ["programming", "math", "tool"],
          "required": false
        }
      }
    }
  }
}
```

- Каждый тип узла имеет уникальный ID (например: `nt_skill`)
- `name` — отображаемое имя типа узла
- `fields` — объект полей этого типа узла:
  - `id` — уникальный идентификатор поля
  - `name` — отображаемое имя поля
  - `type` — тип: `string`, `number`, `boolean`, `enum`
  - `required` — обязательно ли поле
  - `options` — для `enum`: список допустимых значений

**edgeTypes** — объект с описанием типов связей:

```json
{
  "edgeTypes": {
    "et_includes": {
      "name": "includes",
      "directed": true,
      "fields": {
        "f_strength": {
          "id": "f_strength",
          "name": "strength",
          "type": "number",
          "required": false
        }
      }
    }
  }
}
```

- Каждый тип связи имеет уникальный ID (например: `et_includes`)
- `name` — отображаемое имя типа связи
- `directed` — если `true`, связь направленная (стрелка в одну сторону)
- `fields` — объект полей этого типа связи (структура как у nodeTypes)

#### Nodes

```json
{
  "nodes": [
    {
      "id": "1",
      "typeId": "nt_skill",
      "properties": {
        "f_name": "Python",
        "f_category": "programming",
        "f_description": "Язык программирования"
      },
      "position": {
        "x": 75,
        "y": 25
      }
    }
  ]
}
```

- **id** — уникальный идентификатор узла
- **typeId** — ID типа узла из `schema.nodeTypes` (например: `nt_skill`)
- **properties** — объект с данными, определяемыми схемой типа узла. Ключи — это ID полей, а значения — данные
- **position** — объект `{ x, y }` с координатами визуализации

#### Edges

```json
{
  "edges": [
    {
      "id": "e1",
      "source": "1",
      "target": "2",
      "typeId": "et_includes",
      "properties": {}
    }
  ]
}
```

- **id** — уникальный идентификатор связи
- **source** — id узла, из которого исходит связь
- **target** — id узла, на который указывает связь
- **typeId** — ID типа связи из `schema.edgeTypes` (например: `et_includes`)
- **properties** — объект с дополнительными данными связи. Ключи — это ID полей типа связи, значения — данные

## Архитектура приложения

### Технологический стек

- **React 19** — UI компоненты
- **React Flow 11** — визуализация и взаимодействие с графом
- **Zustand** — управление глобальным состоянием (хранилище онтологии)
- **TypeScript** — типизация и безопасность типов
- **Vite** — сборщик проекта
- **SCSS** — стилизация
- **Dagre** — автоматическая раскладка графа

### Ключевые папки и файлы

```
src/
├── App.tsx                        # Главный компонент приложения
├── components/
│   ├── GraphView/                 # Визуализация графа (React Flow)
│   ├── Sidebar/                   # Формы редактирования узлов и связей
│   ├── SchemaEditor/              # Редактор структуры схемы
│   ├── Toolbar/                   # Панель инструментов (Load, Export, etc)
│   └── ...другие компоненты
├── models/
│   ├── ontology.ts                # Типы данных (Node, Edge, Schema, Ontology)
│   ├── validation.ts              # Валидация полей
│   └── defaultValues.ts           # Значения по умолчанию
├── state/
│   └── useOntologyStore.ts        # Zustand хранилище с логикой приложения
├── utils/
│   ├── jsonIO.ts                  # Импорт/экспорт JSON
│   ├── layout.ts                  # Автоматическая раскладка (Dagre)
│   └── ontologyMerge/             # Логика объединения онтологий
└── styles/
    └── ...стили и переменные
```

---

## Дополнительная информация

Важно, в приложении нет многих валидаций и защит от поломки схемы, онтологии и json файла. Пользователю необходимо самому следить за корректностью всех полей, уникальностью значений и тд.

Приложение написано по большей части с применением LLM, часто встречаются нелогичные моменты и костыли. Однако оно было протестировано в большинстве сценариев, найденные ошибки были исправлены.
